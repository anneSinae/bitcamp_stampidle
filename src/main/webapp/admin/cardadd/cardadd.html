<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<title>Stampidle</title>
<link rel="stylesheet"
  href="../../node_modules/bootstrap/dist/css/bootstrap.css">
<link rel="stylesheet" href="../css/default.css">
<link rel="stylesheet" href="../css/common.css">
<link rel="stylesheet" href="../css/cardadd.css">
<link rel="stylesheet" href="../css/template.css">
</head>


<body>
  <div class='container'>
    <div id='header'></div>
    <div id='sidebar'></div>
    <div id='content'>
      <div class='con'>
        <h3>스탬프카드 이미지등록</h3>
        <div class='topLine'></div>
        <div class='usetemp'>
          <button class='tempbtn' id="btn-pop">
            <span class='temptext'>카드템플릿 사용</span>
          </button>
        </div>
        <!-- 프론트영역 -->
        <div class='front'>
          <span class='frontText'>앞면</span> 
          <img src='../image/xbox.png'class='xbox'>
          <div class='frontFile'>
            <!--<input id='fileupload1' type=file name='fileup1' style='display: none;'>
            <button class='filebtn' onclick='document.all.fileup1.click()'>File</button>-->
            <br><img src='../image/i.png' class='i'> <br> <br> <br>
            <p class='text'>
              앞면이미지 미등록시<br> 기존 카페 로고 이미지가<br> 자동 등록됩니다.
            </p>
          </div>
        </div>
        <!-- 중간영역 -->
        <div class='mid' id='mid'>
          <img src='../image/template1.jpg' class='backcard'>
          <div id='stmpside' class='stmpside'>
          </div>
          <span class='midText1'>뒷면<br> <span class='midText2'>스탬프
              찍는 면</span></span>
          <div class='midFile'>
            <!--<input type=file name='fileup2' style='display: none;'>
            <button class='midfilebtn' onclick='document.all.fileup1.click()'>File</button>  -->
          </div>
          <br>
          <div class='midTextAre'>
            <span class='midText3'>현재 스탬프 영역 개수</span><br> <span
              class='midNum'>0</span><span>개</span><br> <br> <span
              class='text'>스탬프가 찍힐 공간 개수만큼 +버튼으로 추<br> 가한 후 도장이 찍힐
              위치를<br>마우스로 조정해 주세요.
            </span>
          </div>
          <div class='btnAre'>
            <button class='mbtn' onclick="remove_item()">-</button>
            <button class='pbtn' onclick='add_item()'>+</button>
          </div>
        </div>
       <!-- 마지막 영역 -->
        <div class='final'>
          <div class='stmpshape'>
            <br> <span class='finalText'>스탬프 모양</span>
            <div class='stmpimgbox' id='images-div'>
            <img src='../image/stmp4.png' class='selectimg'>
            <img id='photo-img'>
            </div>
            <input data-url="cardadd.jsp"id='fileupload' type='file' name='fileup' style='display: none;'>
            <button class='selectFile' onclick='document.all.fileup.click()'>File</button>
          </div>
          <div class='stmpinfo'>
         <span class='info'>※파일 이름은<br>영문만 지원합니다.</span>
         </div>
        </div>
        <div class='btmLine'></div>
        <br>
        <button class='btmsubmit' id='upload-btn'>등록하기</button>
      </div>
    </div>
    
    <!-- 경고창 -->
    <div class='cd_alert1 alert'>
        1개이상 존재해야 합니다.
        <a class='close_alert1 close_alert'>x</a>
    </div>
    
    <div class='cd_alert2 alert'>
        더이상 추가할수 없습니다.
        <a class='close_alert2 close_alert'>x</a>
    </div>
    
   
    <!-- 탬플릿선택 화면 -->
    <div class='tempPop'>
      <div class='template'>
        <button class='btn_top' type='button'></button>
        <div class='text_top'>탬플릿 이미지</div>
        <div class='slideare'>
          <div class='prevare'>
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
          </div>
          <div class='slideshow'>
            <div class="mySlides">
              <img src="../image/template1.jpg"
                style="width: 100%; height: 100%">
            </div>
            <div class="mySlides">
              <img src="../image/template2.jpg" style="width: 100%; height: 100%">
            </div>
            <div class="mySlides">
              <img src="../image/template3.jpg" style="width: 100%; height: 100%">
            </div>
          </div>
          <div class='nextare'>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>
          </div>
          <br>
          <div style="text-align: center">
            <span class="dot" onclick="currentSlide(1)"></span> <span
              class="dot" onclick="currentSlide(2)"></span> <span class="dot"
              onclick="currentSlide(3)"></span>
          </div>
        </div>

        <div class='text_btm'>스탬프 이미지</div>
        <div class='stmp_are'>
          <label class='label1'> <input id='checkimg'class='stmp4' type='radio'
            name='value' style="display: none" checked> <img class='img4'
            src='../image/stmp4.png'>
          </label>
          <label class='label1'> <input id='checkimg' class='stmp1' type='radio'
            name='value' style="display: none"> <img class='img1'
            src='../image/stmp1.png'>
          </label> <label class='label1'> <input id='checkimg' class='stmp2' type='radio'
            name='value' style="display: none"> <img class='img2'
            src='../image/stmp2.png'>
          </label> <label class='label1'> <input id='checkimg' class='stmp3' type='radio'
            name='value' style="display: none"> <img class='img3'
            src='../image/stmp3.png'></label>
          <button type='button' class='button'>카드선택</button>
        </div>
      </div>
    </div>
  </div>

  <script src="../../node_modules/jquery/dist/jquery.js"></script>
  <script src="../../node_modules/bootstrap/dist/js/bootstrap.js"></script>
  <script src="../../node_modules/jquery.ui.touch/jquery.ui.touch.js"></script>
  <script src="../../node_modules/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-meta.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-exif.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-exif-map.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-orientation.js"></script>
<script src="../../node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload-process.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload-image.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="../js/bit.js"></script>
  <script src="../js/common.js"></script>
  
  <!-- div 드래그관련 script -->
  <script>
  $( function() {
	  for(var i = 0; i < 21; i++) {
		  $("<div>").attr("class","stmpare")
		    .css("display","none")
	      .appendTo("#stmpside")
	      .draggable({containment : 'parent' })
	      .addTouch();
	     };
	  })
  </script>
  
  <!-- 파일 업로드 관련 script -->
  <script>
"use strict"

$('#fileupload').fileupload({
    dataType: 'json', /* "서버가 보낸 데이터가 JSON 문자열이다. 자바스크립트 객체로 바꿔라." 라는 의미*/
    done: function (e, data) { // 서버에서 응답이 오면 호출된다. 각 파일 별로 호출된다.
      console.log(data.result);
      var param = data.result.params[0];
      console.log(param);
      $('#photo-path').val(param.filepath);
    },
    processalways: function(e, data) {
        console.log('fileuploadprocessalways()...');
        var img = $('#photo-img');
        if (!img.attr('src')) {
          console.log('미리보기 처리...');
          var canvas = data.files[0].preview;
          var dataURL = canvas.toDataURL();
          img.attr('src', dataURL).css('width', '48px');
        }
    } 
});

</script>
<!-- div 추가,제거 관련 script1 -->
  <script>
    function add_item() {
        /*
      var div = document.createElement('div');
      div.className = "stmpare";
      div.id="stmpare";
      document.getElementById('stmpside').appendChild(div);
      */
      var num = $('.midNum').text();
      $(".stmpside").children().eq(num).css("display","");
      $(".stmpside").children().eq(num).css("left","0px");
      $(".stmpside").children().eq(num).css("top","0px");
    }
    function remove_item() {
      //$('.stmpare').remove();
      /*$('.stmpside .stmpare:last-child').remove();*/
        var num = $('.midNum').text();
      $(".stmpside").children().eq(num-1).css("display","none");
      $(".stmpside").children().eq(num).css("left","0px");
      $(".stmpside").children().eq(num).css("top","0px");
    }
  </script>
  <!-- div 추가,제거 관련 script2 -->
  <script>
    $(function() {
      $('.mbtn').click(function(e) {
        e.preventDefault();
        var stat = $('.midNum').text();
        var num = parseInt(stat, 10);
        num--;
        if (num <= 0) {
          //alert('1개이상 존재해야 합니다.');
          //$('.alert').css("display", "block");
          $('.cd_alert1').fadeIn(100);
          num = 0;
        }
        $('.midNum').text(num);
      });
      $('.pbtn').click(function(e) {
        e.preventDefault();
        var stat = $('.midNum').text();
        var num = parseInt(stat, 10);
        num++;
        if (num > 21) {
             $('.cd_alert2').fadeIn(100);
          //alert('더이상 추가할수 없습니다.');
          num = 21;
        }
        $('.midNum').text(num);
      });
    });
  </script>
  
  <!-- 경고창 관련 script -->
  <script>
  /* alert */
  $(document).ready(function() {
    $('.close_alert1').click(function() {
      //$('.alert').css("display","none");
        $('.cd_alert1').fadeOut(100);
    });
    $('.close_alert2').click(function() {
        //$('.alert').css("display","none");
        $('.cd_alert2').fadeOut(100);
      });
  });
</script>

<!-- 탬플릿 이용버튼 클릭시 팝업관련 script -->
  <script>
/* pulldownPop */
$(document).ready( function(){
    $('#btn-pop').click(function(){
        $('.tempPop').fadeIn(200);
    });
    $('.btn_top').click(function(){
        $('.tempPop').fadeOut(200);
    });
    
    $('.button').click(function(){
        $('.tempPop').fadeOut(200);
    });
});
</script>

<!-- 탬플릿 슬라이드 관련 script -->
<script>
    var slideIndex = 1;
    showSlides(slideIndex);
    function plusSlides(n) {
      showSlides(slideIndex += n);
    }
    function currentSlide(n) {
      showSlides(slideIndex = n);
    }
    function showSlides(n) {
      var i;
      var slides = document.getElementsByClassName("mySlides");
      var dots = document.getElementsByClassName("dot");
      if (n > slides.length) {
        slideIndex = 1
      }
      if (n < 1) {
        slideIndex = slides.length
      }
      
      //window.slideIndex = this.slideIndex;
      for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
      }
      for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
      }
      slides[slideIndex - 1].style.display = "block";
      dots[slideIndex - 1].className += " active";
    }
  </script>
  <script>
  //var selectSlide = $('.mySlides[style=display:block]').attr('src');
  $('.button').click(function(){
	  var cardPath = $('.mySlides[style*="display: block"] img').attr('src');
	  $('.backcard').remove();
	  $('<img>').attr("class","backcard").attr("src",cardPath).insertBefore("#stmpside");
		var stmpPath = $(':checked + img').attr('src');
		$('.selectimg').remove();
		$('<img>').attr("class","selectimg").attr("src",stmpPath).css('z-index','1').insertBefore("#photo-img");
  });

  </script>
</body>
</html>