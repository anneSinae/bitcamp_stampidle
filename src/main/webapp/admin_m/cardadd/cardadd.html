<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Stampidle</title>
<meta name="viewport"
	content="width=device-width, initial-scale=1, user-scalable=no">
<link rel="stylesheet"
	href="../../node_modules/bootstrap/dist/css/bootstrap.css">
<link rel="stylesheet" href="../css/pushy.css">
<link rel="stylesheet" href="../css/common.css">
<link rel="stylesheet" href="../css/cardadd.css">
<link rel="stylesheet" href="../css/template.css">


</head>
<body class='main'>
	<div class="side-left-pushy-button">menu btn</div>
	<div id='header'></div>
	<div id="sideLeftPushy" class="pushy pushy-left sidebar"></div>

	<div id="container">
	<h2 id='pageTit'>스탬프 관리</h2>
		<!-- con -->
		<div class='con'>
			<div class='stmp-top'>
			</div>
			<div class='btn-are'>
				<button class='tempbtn' id="btn-pop">
					<span class='temptext'>탬플릿</span>
				</button>
			</div>
			<br>
			<div class='mid'>
				<img src='../image/template1.jpg' class='backcard'>
				<div id='stmpside' class='stmpside'>
				</div>
				<button class='camera1'><img src='../image/camera.png' alt='camera1' width='40' height='40'></button>
			</div>
			<br> <br> <span class='mid-text'>현재 스탬프영역 개수</span>
			<div class='mid-text-are'>
				<span class='midNum'>0</span><span>개</span>
			</div>
			<br>
			<div class='btnAre'>
				<button class='mbtn' onclick="remove_item()">-</button>
				<button class='pbtn' onclick='add_item()'>+</button>
			</div>
			<div class='mid-text-are2'>
				<span>스탬프가 찍힐 공간 개수만큼<br> +버튼으로 추가한 후 도장이 찍힐 위치를<br>
					드래그하여 조정해 주세요.
				</span>
			</div>
			<div class='final'>
				<span class='final-text'>스탬프 모양</span><br> <br>
				<div class='stmpshape'>
					<div class='stmpimgbox' id='images-div'>
						<img src='../image/stmp4.png' class='selectimg'> 
						<img id='photo-img'>
					<input data-url="cardadd.jsp"id='fileupload' type='file' name='fileup' style='display: none;'>
					<button class='selectFile' onclick='document.all.fileup.click()'><img src='../image/camera.png' alt='camera2' width='28' height='28'></button>
					</div>
				</div>
				<button class='btmsubmit'>카드 설정</button>
			</div>

		<div class='tempPop'>
			<div class='template'>
				<button class='btn_top' type='button'></button>
				<div class='text_top'>탬플릿 이미지</div>
				<div class='slideare'>
					<div class='prevare'>
						<a class="prev" onclick="plusSlides(-1)">&#10094;</a>
					</div>
					<div class='slideshow'>
						<div class="mySlides">
							<img src="../image/template1.jpg"
								style="width: 100%; height: 100%">
						</div>
						<div class="mySlides">
							<img src="../image/template2.jpg"
								style="width: 100%; height: 100%">
						</div>
						<div class="mySlides">
							<img src="../image/template3.jpg"
								style="width: 100%; height: 100%">
						</div>
					</div>
					<div class='nextare'>
						<a class="next" onclick="plusSlides(1)">&#10095;</a>
					</div>
					<br>
					<div style="text-align: center">
						<span class="dot" onclick="currentSlide(1)"></span> <span
							class="dot" onclick="currentSlide(2)"></span> <span class="dot"
							onclick="currentSlide(3)"></span>
					</div>
				</div>

				<div class='text_btm'>스탬프 이미지</div>
				<div class='stmp_are'>
					 <label class='label1'> <input class='stmp4' type='radio'
						name='value' style="display: none" checked> <img class='img4'
						src='../image/stmp4.png'>
					</label>
					<label class='label1'> <input class='stmp1' type='radio'
						name='value' style="display: none"> <img class='img1'
						src='../image/stmp1.png'>
					</label> <label class='label1'> <input class='stmp2' type='radio'
						name='value' style="display: none"> <img class='img2'
						src='../image/stmp2.png'>
					</label> <label class='label1'> <input class='stmp3' type='radio'
						name='value' style="display: none"> <img class='img3'
						src='../image/stmp3.png'></label>
					<button type='button' class='button'>카드선택</button>
				</div>
			</div>
		</div>
		<!-- 탬플릿 팝업 끝 -->
		</div>
		<!-- //con -->
	</div>


	<script src="../../node_modules/jquery/dist/jquery.js"></script>
	<script src="../../node_modules/bootstrap/dist/js/bootstrap.js"></script>
	<script src="../js/bit.js"></script>
	<script src="../js/common.js"></script>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="../../node_modules/jquery.ui.touch/jquery.ui.touch.js"></script>
	<script src="../js/pushy.js"></script>
	<script src="../js/pushy_stampidle.js"></script>
	<script src="../../node_modules/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-meta.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-exif.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-exif-map.js"></script>
<script src="../../node_modules/blueimp-load-image/js/load-image-orientation.js"></script>
<script src="../../node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload-process.js"></script>
<script src="../../node_modules/blueimp-file-upload/js/jquery.fileupload-image.js"></script>
	<script>
			/* pulldownPop */
			$(document).ready(function() {
				$('#btn-pop').click(function() {
					$('.tempPop').fadeIn(200);
				});
				$('.btn_top').click(function() {
					$('.tempPop').fadeOut(200);
				});

				$('.button').click(function() {
					$('.tempPop').fadeOut(200);
				});
			});
		</script>

	<!-- 탬플릿 슬라이드 관련 script -->
	<script>
			var slideIndex = 1;
			showSlides(slideIndex);
			function plusSlides(n) {
				showSlides(slideIndex += n);
			}
			function currentSlide(n) {
				showSlides(slideIndex = n);
			}
			function showSlides(n) {
				var i;
				var slides = document.getElementsByClassName("mySlides");
				var dots = document.getElementsByClassName("dot");
				if (n > slides.length) {
					slideIndex = 1
				}
				if (n < 1) {
					slideIndex = slides.length
				}
				for (i = 0; i < slides.length; i++) {
					slides[i].style.display = "none";
				}
				for (i = 0; i < dots.length; i++) {
					dots[i].className = dots[i].className
							.replace(" active", "");
				}
				slides[slideIndex - 1].style.display = "block";
				dots[slideIndex - 1].className += " active";
			}
		</script>

	<!-- div 추가,제거 관련 script1 -->
	<script>
			function add_item() {
				var num = $('.midNum').text();
				$(".stmpside").children().eq(num).css("display", "");
				$(".stmpside").children().eq(num).css("left", "0px");
				$(".stmpside").children().eq(num).css("top", "0px");
			}
			function remove_item() {
				var num = $('.midNum').text();
				$(".stmpside").children().eq(num-1).css("display", "none");
				$(".stmpside").children().eq(num).css("left", "0px");
				$(".stmpside").children().eq(num).css("top", "0px");
			}
		</script>
	<!-- div 추가,제거 관련 script2 -->
	<script>
			$(function() {
				$('.mbtn').click(function(e) {
					e.preventDefault();
					var stat = $('.midNum').text();
					var num = parseInt(stat, 10);
					num--;
					if (num <= 0) {
						$('.cd_alert1').fadeIn(100);
						num = 0;
					}
					$('.midNum').text(num);
				});
				$('.pbtn').click(function(e) {
					e.preventDefault();
					var stat = $('.midNum').text();
					var num = parseInt(stat, 10);
					num++;
					if (num > 21) {
						$('.cd_alert2').fadeIn(100);
						//alert('더이상 추가할수 없습니다.');
						num = 21;
					}
					$('.midNum').text(num);
				});
			});
		</script>

	<script>
			$(function() {
				for (var i = 0; i < 21; i++) {
					$("<div>").attr("class", "stmpare").css("display", "none")
							.appendTo("#stmpside").draggable({
								containment : 'parent'
							}).addTouch();
				}
				;
			})
		</script>
		<script>
  $( function() {
    for(var i = 0; i < 21; i++) {
      $("<div>").attr("class","stmpare")
        .css("display","none")
        .appendTo("#stmpside")
        .draggable({containment : 'parent' })
        .addTouch();
       };
    })
  </script>
  <script>
"use strict"

$('#fileupload').fileupload({
    dataType: 'json', /* "서버가 보낸 데이터가 JSON 문자열이다. 자바스크립트 객체로 바꿔라." 라는 의미*/
    done: function (e, data) { // 서버에서 응답이 오면 호출된다. 각 파일 별로 호출된다.
      console.log(data.result);
      var param = data.result.params[0];
      console.log(param);
      $('#photo-path').val(param.filepath);
    },
    processalways: function(e, data) {
        console.log('fileuploadprocessalways()...');
        var img = $('#photo-img');
        if (!img.attr('src')) {
          console.log('미리보기 처리...');
          var canvas = data.files[0].preview;
          var dataURL = canvas.toDataURL();
          img.attr('src', dataURL).css('width', '100%').css('max-height','68px');
        }
    } 
});

</script>

<script>
  //var selectSlide = $('.mySlides[style=display:block]').attr('src');
  $('.button').click(function(){
    var cardPath = $('.mySlides[style*="display: block"] img').attr('src');
    $('.backcard').remove();
    $('<img>').attr("class","backcard").attr("src",cardPath).insertBefore(".stmpside");
    var stmpPath = $(':checked + img').attr('src');
    $('.selectimg').remove();
    $('<img>').attr("class","selectimg").attr("src",stmpPath).css('z-index','1').insertBefore("#photo-img");
  });

  </script>
</body>
</html>
